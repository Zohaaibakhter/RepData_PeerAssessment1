Project Assignment 
=================
We are first going to load the Activity Monitoring Data

```{r, echo=TRUE,warning=FALSE, message=FALSE}
activity <- read.csv("activity.csv", na.strings="NA")
```

Histogram for number of steps taken each day 

```{r, echo=TRUE,warning=FALSE,message=FALSE}
library(dplyr)
totalsteps <- activity %>% group_by(date) %>% summarize(sum(steps,na.rm=FALSE))
hist(totalsteps$`sum(steps, na.rm = FALSE)`, main = "Total No. of Steps per day", xlab = "Steps")
```


Calculating average daily activity pattern 



```{r, echo=TRUE,warning=FALSE, message=FALSE}
library(dplyr)
sumByDay <- activity %>% group_by(date) %>% summarize(total_steps=sum(steps),
mean_steps=mean(steps), median_steps=median(steps[steps>0]))
```

```{r, echo=TRUE,warning=FALSE, message=FALSE}
activityPattern <- tapply(activity$steps, activity$interval, mean, na.rm = TRUE)
xnames <- names(activityPattern)
{plot(activityPattern, xaxt="n", type="l", main = "Daily Activty Pattern", xlab = "Interval", ylab = "Days" )
axis(1, at=1:length(xnames), label=xnames)}
max(activityPattern)
which.max(activityPattern)
```

The total number of missing values in the dataset 

```{r, echo=TRUE,warning=FALSE, message=FALSE}
sum(is.na(activity$steps))
```

Replacing the missing values with the mean 

```{r, echo=TRUE,warning=FALSE, message=FALSE}
activity$steps<-ave(activity$steps,activity$interval,FUN=function(x) 
  ifelse(is.na(x), mean(x,na.rm=TRUE), x))
```


Histogram for total number of steps taken per day 

```{r, echo=TRUE,warning=FALSE, message=FALSE}
totalsteps <- activity %>% group_by(date) %>% summarize(sum(steps,na.rm=FALSE))
hist(totalsteps$`sum(steps, na.rm = FALSE)`, main = "Total No. of Steps per day", xlab = "Steps")

sumByDay <- activity %>% group_by(date) %>% summarize(total_steps=sum(steps),
mean_steps=mean(steps), median_steps=median(steps[steps>0]))
```

Creating a new factor variable for weekdays and weekends

```{r, echo=TRUE,warning=FALSE, message=FALSE}
library(lubridate)
activity$date<-  ymd(activity$date)
activity$Day <- weekdays(activity$date)
activity$Day[grepl("Saturday|Sunday", activity$Day)] <- "Weekend"
activity$Day[grepl("Monday|Tuesday|Thursday|Friday|Wednesday", activity$Day)] <- "Weekday"
```

Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends

```{r, echo=TRUE,warning=FALSE, message=FALSE}
library(ggplot2)
MeanByDay <- activity %>% group_by(interval, Day) %>% summarise(mean_steps=mean(steps))
g <- ggplot(MeanByDay, aes(interval, mean_steps)) 
g + geom_line() + facet_grid(.~Day) + labs(x = "Interval", y = "Steps")
```






